# 智能定时提醒插件 🎯

基于AI函数调用的智能定时提醒插件，支持自然语言交互和传统命令管理，为LangBot用户提供便捷的定时任务功能。

> 🔧 **v1.2.0 重大更新**：优化时间解析引擎，提升提醒稳定性！

## 🔧 技术改进 (v1.2.0)

### 🎯 智能时间解析重大升级

- ✅ **重写时间解析引擎**：全新的中文自然语言时间解析系统
- ✅ **支持复杂时间表达**：
  - "明天早上九点" → 自动识别为明天09:00
  - "每周四晚上21点" → 自动识别为每周重复，下个周四21:00
  - "后天下午3点" → 后天15:00
- ✅ **智能重复检测**：自动识别"每天"、"每周"、"每月"等重复模式
- ✅ **预处理优化**：数字转换、时间词汇标准化
- ✅ **多层解析策略**：dateparser + 增强手动解析，确保高识别率

### 消息发送优化 (v1.1.0)

- ✅ **修复消息发送失败问题**：解决了 `aiocqhttp.exceptions.ApiNotAvailable` 错误
- ✅ **采用LangBot标准API**：使用 `host.send_active_message()` 方法
- ✅ **优化@功能**：确保群聊中正确@提醒设置者
- ✅ **增强错误处理**：添加自动重试机制和详细错误日志

### 核心特性

### 🤖 AI智能交互

- **自然语言理解**：直接对机器人说话即可设置提醒
- **智能时间解析**：支持各种时间表达方式
- **自动函数调用**：基于GPT的函数调用能力

### ⏰ 强大的提醒功能

- **灵活时间设置**：相对时间、绝对时间、自然语言时间
- **重复提醒支持**：单次、每天、每周、每月
- **精确消息发送**：支持群聊和私聊，自动@提及用户
- **数据持久化**：提醒数据自动保存，重启后恢复

### 🛠️ 完善的管理功能

- **提醒列表查看**：查看所有活跃提醒
- **灵活控制**：删除、暂停、恢复提醒
- **状态管理**：实时显示提醒状态

## 🚀 快速开始

### 安装方式

1. **通过插件管理页面安装**：

**手动安装**：

```bash
!plugin get https://github.com/Wedjat98/QReminderPlugin
```

## 📖 使用指南

### 🌟 智能AI设置（推荐使用）

直接对机器人说话，AI会自动理解并设置提醒：

```
# 🕐 相对时间
"提醒我30分钟后开会"
"1小时后提醒我休息"
"2天后提醒我交作业"

# 📅 明确日期时间  
"明天早上9点提醒我上班"
"后天下午3点提醒我开会"
"今晚8点提醒我看电视"

# 🗓️ 星期时间
"下周四晚上21点提醒我收看邦tv"
"周五上午10点提醒我开会"
"星期一下午2点提醒我汇报工作"

# 🔄 重复提醒（自动检测）
"每天早上7点提醒我起床"
"每周五下午6点提醒我写周报"
"每月1号提醒我交房租"

# 🎯 复杂表达
"每周四晚上9点提醒我追剧"
"明天上午九点半提醒我面试"
"后天中午12点提醒我吃饭"
```

### 📋 传统命令管理

| 命令                                       | 功能         | 示例           |
| ------------------------------------------ | ------------ | -------------- |
| `查看提醒` / `提醒列表` / `我的提醒` | 查看所有提醒 | `查看提醒`   |
| `删除提醒 [序号]`                        | 删除指定提醒 | `删除提醒 1` |
| `暂停提醒 [序号]`                        | 暂停指定提醒 | `暂停提醒 2` |
| `恢复提醒 [序号]`                        | 恢复指定提醒 | `恢复提醒 2` |
| `提醒帮助` / `定时提醒帮助`            | 查看帮助信息 | `提醒帮助`   |

### 🕐 支持的时间格式

#### 相对时间

- `30分钟后`、`1小时后`、`2天后`
- `明天`、`后天`、`下周`、`下个月`

#### 绝对时间

- `今晚8点`、`明天上午9点`
- `下周一下午3点`、`下个月15号`
- `2024-12-25 10:00`

#### 重复类型

- `不重复`（默认）：一次性提醒
- `每天`：每天重复
- `每周`：每周重复
- `每月`：每月重复

## 💡 使用场景

### 🏢 工作场景

```
"明天上午10点提醒我开晨会"
"每天下午6点提醒我写工作日报"
"下周五提醒我提交项目报告"
```

### 🏠 生活场景

```
"30分钟后提醒我关火"
"每天晚上9点提醒我给花浇水"
"每周日提醒我打扫卫生"
```

### 💊 健康管理

```
"每天早上8点提醒我吃维生素"
"每4小时提醒我喝水"
"每月1号提醒我称体重"
```

### 🎯 学习计划

```
"每天晚上8点提醒我背单词"
"每周三提醒我复习课程"
"考试前一周提醒我准备复习资料"
```

## 🔧 高级功能

### 提醒状态管理

查看提醒列表时，会显示每个提醒的状态：

```
📋 您的提醒列表：
1. 开会 - 2024-06-06 15:30 (不重复) ✅ 活跃
2. 吃药 - 2024-06-06 20:00 (每天) ⏸️ 暂停
3. 写报告 - 2024-06-07 09:00 (每周) ✅ 活跃
```

### 智能时间识别

插件使用先进的自然语言处理技术，能够理解各种时间表达：

- **中文时间**：`明天下午三点`、`后天上午`
- **英文时间**：`tomorrow 3pm`、`next Monday`
- **混合表达**：`下周一 15:00`、`明天 9:30`

### 消息发送特性

- **精确定位**：在群聊中会@提及设置提醒的用户
- **智能路由**：自动识别消息来源（群聊/私聊）
- **时间准确**：基于系统时间精确触发

## 📁 文件结构

```
ReminderPlugin/
├── main.py          # 主程序文件
├── manifest.yaml    # 插件配置清单
├── requirements.txt # 依赖库列表
├── README.md        # 使用说明文档
├── __init__.py      # Python包标识
└── reminders.json   # 提醒数据存储（自动生成）
```

## ⚙️ 配置选项

在插件管理页面可以配置以下选项：

| 配置项                      | 默认值        | 说明                 |
| --------------------------- | ------------- | -------------------- |
| `max_reminders_per_user`  | 50            | 每个用户最大提醒数量 |
| `reminder_advance_notice` | 0             | 提前通知时间（分钟） |
| `enable_group_reminders`  | true          | 是否启用群组提醒     |
| `timezone`                | Asia/Shanghai | 默认时区设置         |

### 调试信息

如需查看详细的运行日志，可以：

1. 检查LangBot日志文件
2. 查看插件的调试输出
3. 确认 `reminders.json`文件内容

### 数据备份

提醒数据存储在 `reminders.json`文件中，建议定期备份：

```bash
# 备份提醒数据
cp reminders.json reminders_backup_$(date +%Y%m%d).json
```

## 📄 许可证

本项目采用 MIT 许可证。详见 [LICENSE](LICENSE) 文件。

## 🙏 致谢

感谢以下项目和贡献者：

- [LangBot](https://github.com/RockChinQ/LangBot) - 强大的AI聊天机器人框架
- [dateparser](https://github.com/scrapinghub/dateparser) - 自然语言日期解析库
- 所有测试用户和反馈者

---

让智能提醒让生活更有序！🎯
